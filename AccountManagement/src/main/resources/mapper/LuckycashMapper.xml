<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.digitalchina.xa.it.dao.LuckycashDAO" >
  <sql id="BASE_TABLE">
    t_luckycash
  </sql>

  <sql id="BASE_COLUMN">
    id,luckyNum,available,luckyGuys,luckyGuysCount,availableTime
  </sql>

  <insert id="insert" parameterType="com.digitalchina.xa.it.model.LuckycashDomain">
    INSERT INTO
      <include refid="BASE_TABLE"/>
    <trim prefix="(" suffix=")" suffixOverrides=",">
      id,luckyNum,available,luckyGuys,luckyGuysCount,availableTime,
    </trim>
    <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
      #{id, jdbcType=INTEGER},#{luckyNum, jdbcType=VARCHAR},#{available, jdbcType=INTEGER},#{luckyGuys, jdbcType=VARCHAR},#{luckyGuysCount, jdbcType=INTEGER},#{availableTime, jdbcType=TIMESTAMP},
    </trim>
  </insert>

  <select id="selectAvailableLuckyNum" resultType="com.digitalchina.xa.it.model.LuckycashDomain">
      SELECT
        <include refid="BASE_COLUMN"/>
      FROM
        <include refid="BASE_TABLE"/>
      where available = 0
  </select>
  
	<update id="updateLuckyGuysCount" parameterType="java.lang.Integer">
	   UPDATE 
	   <include refid="BASE_TABLE"/>
	   SET    luckyGuysCount = luckyGuysCount - 1
	   WHERE  id = #{id, jdbcType=INTEGER}
	</update>
	
	<update id="updateAvailable" parameterType="java.lang.Integer">
	   UPDATE 
	   <include refid="BASE_TABLE"/>
	   SET    available = 1
	   WHERE  id = #{id, jdbcType=INTEGER}
	</update>
</mapper>